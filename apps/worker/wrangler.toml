name = "chatkin-os-worker"
main = "src/index.ts"
compatibility_date = "2024-11-22"
compatibility_flags = ["nodejs_compat"]

# Production routes - applies to default deployment
routes = [
  { pattern = "chatkin.ai/api/health", zone_name = "chatkin.ai" },
  { pattern = "chatkin.ai/api/ai/*", zone_name = "chatkin.ai" },
  { pattern = "chatkin.ai/api/upload", zone_name = "chatkin.ai" },
  { pattern = "chatkin.ai/api/save-to-library", zone_name = "chatkin.ai" },
  { pattern = "chatkin.ai/api/delete-file", zone_name = "chatkin.ai" },
  { pattern = "chatkin.ai/api/temp-files/*", zone_name = "chatkin.ai" },
  { pattern = "chatkin.ai/api/files/*", zone_name = "chatkin.ai" }
]

[env.production]
name = "chatkin-os-worker"

[[env.production.r2_buckets]]
binding = "CHATKIN_BUCKET"
bucket_name = "chatkin-files"

[[env.production.r2_buckets]]
binding = "CHATKIN_TEMP_BUCKET"
bucket_name = "chatkin-files-temp"

[[r2_buckets]]
binding = "CHATKIN_BUCKET"
bucket_name = "chatkin-files"
preview_bucket_name = "chatkin-files-dev"

[[r2_buckets]]
binding = "CHATKIN_TEMP_BUCKET"
bucket_name = "chatkin-files-temp"
preview_bucket_name = "chatkin-files-temp-dev"

# Environment variables (set via wrangler secret put)
# ANTHROPIC_API_KEY
# SUPABASE_URL
# SUPABASE_ANON_KEY
# SENTRY_DSN (optional)
